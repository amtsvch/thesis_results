@Override                                                                                              @Override                                                                                           
public URI getURI(String name) {                                                                       public URI getURI(String name) {                                                                    
File f = new File(name);                                                                               File f = new File(name);                                                                            
if (!f.isAbsolute()) {                                                                                 if (!f.isAbsolute()) {                                                                              
f = new File(catalinaBaseFile, name);                                                                  f = new File(catalinaBaseFile, name);                                                               
}                                                                                                      }                                                                                                   
if (f.isFile()) {                                                                                      if (f.isFile()) {                                                                                   
return f.toURI();                                                                                      return f.toURI();                                                                                   
}                                                                                                      }                                                                                                   
// Try classloader                                                                                     // Try classloader                                                                                  
try {                                                                                                  try {                                                                                               
URL resource = getClass().getClassLoader().getResource(name);                                          URL resource = getClass().getClassLoader().getResource(name);                                       
if (resource != null) {                                                                                if (resource != null) {                                                                             
return resource.toURI();                                                                               return resource.toURI();                                                                            
}                                                                                                      }                                                                                                   
} catch (Exception e) {                                                                                } catch (Exception e) {                                                                             
// Ignore                                                                                              // Ignore                                                                                           
}                                                                                                      }                                                                                                   
// Then try URI.                                                                                     | return getURIInternal(name);                                                                        
// Using resolve() enables the code to handle relative paths that did                                |                                                                                                     
// not point to a file                                                                               |                                                                                                     
URI uri;                                                                                             |                                                                                                     
if (catalinaBaseUri != null) {                                                                       |                                                                                                     
uri = catalinaBaseUri.resolve(name);                                                                 |                                                                                                     
} else {                                                                                             |                                                                                                     
uri = URI.create(name);                                                                              |                                                                                                     
}                                                                                                      }                                                                                                   
return uri;                                                                                          |                                                                                                     
}                                                                                                    |                                                                                                     
