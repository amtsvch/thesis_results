@Test
public void testSameSiteCookies() {
    LegacyCookieProcessor legacy = new LegacyCookieProcessor();
    Rfc6265CookieProcessor rfc6265 = new Rfc6265CookieProcessor();
    Cookie cookie = new Cookie("foo", "bar");
    Assert.assertEquals("foo=bar", legacy.generateHeader(cookie, null));
    Assert.assertEquals("foo=bar", rfc6265.generateHeader(cookie, null));
    legacy.setSameSiteCookies("unset");
    rfc6265.setSameSiteCookies("unset");
    Assert.assertEquals("foo=bar", legacy.generateHeader(cookie, null));
    Assert.assertEquals("foo=bar", rfc6265.generateHeader(cookie, null));
    legacy.setSameSiteCookies("none");
    rfc6265.setSameSiteCookies("none");
    Assert.assertEquals("foo=bar; SameSite=None", legacy.generateHeader(cookie, null));
    Assert.assertEquals("foo=bar; SameSite=None", rfc6265.generateHeader(cookie, null));
    legacy.setSameSiteCookies("lax");
    rfc6265.setSameSiteCookies("lax");
    Assert.assertEquals("foo=bar; SameSite=Lax", legacy.generateHeader(cookie, null));
    Assert.assertEquals("foo=bar; SameSite=Lax", rfc6265.generateHeader(cookie, null));
    legacy.setSameSiteCookies("strict");
    rfc6265.setSameSiteCookies("strict");
    Assert.assertEquals("foo=bar; SameSite=Strict", legacy.generateHeader(cookie, null));
    Assert.assertEquals("foo=bar; SameSite=Strict", rfc6265.generateHeader(cookie, null));
    cookie.setSecure(true);
    cookie.setHttpOnly(true);
    legacy.setSameSiteCookies("unset");
    rfc6265.setSameSiteCookies("unset");
    Assert.assertEquals("foo=bar; Secure; HttpOnly", legacy.generateHeader(cookie, null));
    Assert.assertEquals("foo=bar; Secure; HttpOnly", rfc6265.generateHeader(cookie, null));
    legacy.setSameSiteCookies("none");
    rfc6265.setSameSiteCookies("none");
    Assert.assertEquals("foo=bar; Secure; HttpOnly; SameSite=None", legacy.generateHeader(cookie, null));
    Assert.assertEquals("foo=bar; Secure; HttpOnly; SameSite=None", rfc6265.generateHeader(cookie, null));
    legacy.setSameSiteCookies("lax");
    rfc6265.setSameSiteCookies("lax");
    Assert.assertEquals("foo=bar; Secure; HttpOnly; SameSite=Lax", legacy.generateHeader(cookie, null));
    Assert.assertEquals("foo=bar; Secure; HttpOnly; SameSite=Lax", rfc6265.generateHeader(cookie, null));
    legacy.setSameSiteCookies("strict");
    rfc6265.setSameSiteCookies("strict");
    Assert.assertEquals("foo=bar; Secure; HttpOnly; SameSite=Strict", legacy.generateHeader(cookie, null));
    Assert.assertEquals("foo=bar; Secure; HttpOnly; SameSite=Strict", rfc6265.generateHeader(cookie, null));
}