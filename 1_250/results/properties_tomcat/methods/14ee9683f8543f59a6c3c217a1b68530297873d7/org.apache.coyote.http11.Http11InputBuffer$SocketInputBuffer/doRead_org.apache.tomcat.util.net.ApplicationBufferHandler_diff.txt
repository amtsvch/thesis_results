@Override                                                                                              @Override                                                                                           
public int doRead(ApplicationBufferHandler handler) throws IOException {                               public int doRead(ApplicationBufferHandler handler) throws IOException {                            
if (byteBuffer.position() &gt;= byteBuffer.limit()) {                                                  if (byteBuffer.position() &gt;= byteBuffer.limit()) {                                               
// The application is reading the HTTP request body which is                                         | // The application is reading the HTTP request body                                                 
// always a blocking operation.                                                                      | boolean block = (request.getReadListener() == null);                                                
if (!fill(true)) {                                                                                   | if (!fill(block)) {                                                                                 
                                                                                                     | if (block) {                                                                                        
return -1;                                                                                             return -1;                                                                                          
                                                                                                     | } else {                                                                                            
                                                                                                     | return 0;                                                                                           
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
                                                                                                     | }                                                                                                   
int length = byteBuffer.remaining();                                                                   int length = byteBuffer.remaining();                                                                
handler.setByteBuffer(byteBuffer.duplicate());                                                         handler.setByteBuffer(byteBuffer.duplicate());                                                      
byteBuffer.position(byteBuffer.limit());                                                               byteBuffer.position(byteBuffer.limit());                                                            
return length;                                                                                         return length;                                                                                      
}                                                                                                      }                                                                                                   
