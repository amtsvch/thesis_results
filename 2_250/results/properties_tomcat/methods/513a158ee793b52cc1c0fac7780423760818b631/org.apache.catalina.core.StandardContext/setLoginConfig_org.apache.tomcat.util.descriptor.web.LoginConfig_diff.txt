/**                                                                                                    /**                                                                                                 
* Set the login configuration descriptor for this web application.                                     * Set the login configuration descriptor for this web application.                                  
*                                                                                                      *                                                                                                   
* @param config The new login configuration                                                            * @param config The new login configuration                                                         
*/                                                                                                     */                                                                                                  
@Override                                                                                              @Override                                                                                           
public void setLoginConfig(LoginConfig config) {                                                       public void setLoginConfig(LoginConfig config) {                                                    
// Validate the incoming property value                                                                // Validate the incoming property value                                                             
if (config == null)                                                                                  | if (config == null) {                                                                               
throw new IllegalArgumentException(sm.getString("standardContext.loginConfig.required"));              throw new IllegalArgumentException(sm.getString("standardContext.loginConfig.required"));           
                                                                                                     | }                                                                                                   
String loginPage = config.getLoginPage();                                                              String loginPage = config.getLoginPage();                                                           
if ((loginPage != null) && !loginPage.startsWith("/")) {                                               if ((loginPage != null) && !loginPage.startsWith("/")) {                                            
if (isServlet22()) {                                                                                   if (isServlet22()) {                                                                                
if (log.isDebugEnabled())                                                                            | if (log.isDebugEnabled()) {                                                                         
log.debug(sm.getString("standardContext.loginConfig.loginWarning", loginPage));                        log.debug(sm.getString("standardContext.loginConfig.loginWarning", loginPage));                     
                                                                                                     | }                                                                                                   
config.setLoginPage("/" + loginPage);                                                                  config.setLoginPage("/" + loginPage);                                                               
} else {                                                                                               } else {                                                                                            
throw new IllegalArgumentException(sm.getString("standardContext.loginConfig.loginPage", loginPage))   throw new IllegalArgumentException(sm.getString("standardContext.loginConfig.loginPage", loginPage))
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
String errorPage = config.getErrorPage();                                                              String errorPage = config.getErrorPage();                                                           
if ((errorPage != null) && !errorPage.startsWith("/")) {                                               if ((errorPage != null) && !errorPage.startsWith("/")) {                                            
if (isServlet22()) {                                                                                   if (isServlet22()) {                                                                                
if (log.isDebugEnabled())                                                                            | if (log.isDebugEnabled()) {                                                                         
log.debug(sm.getString("standardContext.loginConfig.errorWarning", errorPage));                        log.debug(sm.getString("standardContext.loginConfig.errorWarning", errorPage));                     
                                                                                                     | }                                                                                                   
config.setErrorPage("/" + errorPage);                                                                  config.setErrorPage("/" + errorPage);                                                               
} else {                                                                                               } else {                                                                                            
throw new IllegalArgumentException(sm.getString("standardContext.loginConfig.errorPage", errorPage))   throw new IllegalArgumentException(sm.getString("standardContext.loginConfig.errorPage", errorPage))
}                                                                                                      }                                                                                                   
}                                                                                                      }                                                                                                   
// Process the property setting change                                                                 // Process the property setting change                                                              
LoginConfig oldLoginConfig = this.loginConfig;                                                         LoginConfig oldLoginConfig = this.loginConfig;                                                      
this.loginConfig = config;                                                                             this.loginConfig = config;                                                                          
support.firePropertyChange("loginConfig", oldLoginConfig, this.loginConfig);                           support.firePropertyChange("loginConfig", oldLoginConfig, this.loginConfig);                        
}                                                                                                      }                                                                                                   
