/**                                                                                                    /**                                                                                                 
* Add a new servlet mapping, replacing any existing mapping for                                        * Add a new servlet mapping, replacing any existing mapping for                                     
* the specified pattern.                                                                               * the specified pattern.                                                                            
*                                                                                                      *                                                                                                   
* @param pattern URL pattern to be mapped                                                              * @param pattern URL pattern to be mapped                                                           
* @param name Name of the corresponding servlet to execute                                             * @param name Name of the corresponding servlet to execute                                          
* @param jspWildCard true if name identifies the JspServlet                                            * @param jspWildCard true if name identifies the JspServlet                                         
* and pattern contains a wildcard; false otherwise                                                     * and pattern contains a wildcard; false otherwise                                                  
*                                                                                                      *                                                                                                   
* @exception IllegalArgumentException if the specified servlet name                                    * @exception IllegalArgumentException if the specified servlet name                                 
*  is not known to this Context                                                                        *  is not known to this Context                                                                     
*/                                                                                                     */                                                                                                  
@Override                                                                                              @Override                                                                                           
public void addServletMappingDecoded(String pattern, String name, boolean jspWildCard) {               public void addServletMappingDecoded(String pattern, String name, boolean jspWildCard) {            
// Validate the proposed mapping                                                                       // Validate the proposed mapping                                                                    
if (findChild(name) == null)                                                                         | if (findChild(name) == null) {                                                                      
throw new IllegalArgumentException(sm.getString("standardContext.servletMap.name", name));             throw new IllegalArgumentException(sm.getString("standardContext.servletMap.name", name));          
                                                                                                     | }                                                                                                   
String adjustedPattern = adjustURLPattern(pattern);                                                    String adjustedPattern = adjustURLPattern(pattern);                                                 
if (!validateURLPattern(adjustedPattern))                                                            | if (!validateURLPattern(adjustedPattern)) {                                                         
throw new IllegalArgumentException(sm.getString("standardContext.servletMap.pattern", adjustedPatter   throw new IllegalArgumentException(sm.getString("standardContext.servletMap.pattern", adjustedPatter
                                                                                                     | }                                                                                                   
// Add this mapping to our registered set                                                              // Add this mapping to our registered set                                                           
synchronized (servletMappingsLock) {                                                                   synchronized (servletMappingsLock) {                                                                
String name2 = servletMappings.get(adjustedPattern);                                                   String name2 = servletMappings.get(adjustedPattern);                                                
if (name2 != null) {                                                                                   if (name2 != null) {                                                                                
// Don't allow more than one servlet on the same pattern                                               // Don't allow more than one servlet on the same pattern                                            
Wrapper wrapper = (Wrapper) findChild(name2);                                                          Wrapper wrapper = (Wrapper) findChild(name2);                                                       
wrapper.removeMapping(adjustedPattern);                                                                wrapper.removeMapping(adjustedPattern);                                                             
}                                                                                                      }                                                                                                   
servletMappings.put(adjustedPattern, name);                                                            servletMappings.put(adjustedPattern, name);                                                         
}                                                                                                      }                                                                                                   
Wrapper wrapper = (Wrapper) findChild(name);                                                           Wrapper wrapper = (Wrapper) findChild(name);                                                        
wrapper.addMapping(adjustedPattern);                                                                   wrapper.addMapping(adjustedPattern);                                                                
fireContainerEvent("addServletMapping", adjustedPattern);                                              fireContainerEvent("addServletMapping", adjustedPattern);                                           
}                                                                                                      }                                                                                                   
